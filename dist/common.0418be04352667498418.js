(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"4EzH":function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n=function(t){this.context=t}},DnA4:function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r("AytR"),o=r("6blF"),i=r("LvDl"),a=function(){function t(){}return t.prototype.createOptionsUrl=function(t,e){var r="?";return i.forEach(t,function(t,n){e&&"account_id"===n||(r+=("pageSize"===n?"limit":n)+"="+t+"&")}),r},t.prototype.store=function(t){return this.http.post(n.a.AUTH_URL+"/v1/"+this.entity,t)},t.prototype.get=function(t){var e=this;return void 0===t&&(t=!1),new o.a(function(r){e.http.get(n.a.AUTH_URL+"/v1/"+e.entity+(t?"/"+t:"")).subscribe(function(t){r.next(t.data)},function(t){r.error(t)})})},t.prototype.delete=function(t){return this.http.delete(n.a.AUTH_URL+"/v1/"+this.entity+"/"+t)},t.prototype.getData=function(t){var e=this.createOptionsUrl(t);return this.http.get(n.a.AUTH_URL+"/v1/"+this.entity+e)},t.prototype.update=function(t){return this.http.put(n.a.AUTH_URL+"/v1/"+this.entity+"/"+t.id,t)},t}()},bJVR:function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return o});var n={distributor:["distributor_content"],fabricator:["fabricator_content"]},o={1:{role:"distributor",path:"app/app"},3:{role:"fabricator",path:"app/factory"},2:{role:"distributor",path:"app/app"}}},mzlT:function(t,e,r){"use strict";r.d(e,"a",function(){return o}),r("zpWJ");var n=r("R2Xm"),o=function(){function t(t){this.authService=t}return t.prototype.canActivate=function(){var t=Object(n.e)("app");return t||this.authService.logout(),t},t}()},"n/un":function(t,e,r){"use strict";r.d(e,"a",function(){return a}),r.d(e,"b",function(){return c});var n=r("F/XL"),o=(r("4baO"),r("R2Xm")),i=r("bJVR"),a=function(){function t(t){this.router=t}return t.prototype.redirectTo=function(t){"UNAUTHORIZED"===t.toUpperCase()&&this.router.navigate([Object(o.c)()||"login"])},t}(),c=function(){function t(t,e){this.aclService=t,this.aclRedirection=e}return t.prototype.match=function(t,e){return e.test(t.url)},t.prototype.checkPermission=function(t){return this.aclService.can(i.a[t][0])},t.prototype.routesToCheck=function(){return{app:/^\/app\/app?[\D]+$/,fabricator:/^\/app\/fabricator?[\D]+$/,admin:/^\/admin?[\D]+$/}},t.prototype.matchUrl=function(t){var e;return this.match(t,this.routesToCheck().app)&&this.checkPermission("distributor")?e=Object(n.a)(!0):this.match(t,this.routesToCheck().fabricator)&&this.checkPermission("fabricator")?e=Object(n.a)(!0):this.match(t,this.routesToCheck().admin)&&this.checkPermission("distributor")&&(e=Object(n.a)(!0)),e},t.prototype.resolve=function(t,e){if(this.matchUrl(e))return Object(n.a)(!0);this.aclRedirection.redirectTo("Unauthorized")},t}()},zpWJ:function(t,e,r){"use strict";r.d(e,"a",function(){return u});var n=r("R2Xm"),o=r("AytR"),i=r("6blF"),a=(r("4baO"),r("bJVR")),c=r("LvDl"),u=function(){function t(t,e,r){this.router=t,this.http=e,this.aclService=r}return t.prototype.handleLogin=function(t){var e=this;return new i.a(function(r){e[t.hasOwnProperty("confirm_password")?"register":"login"](t).subscribe(function(){return r.next(!0)},function(){return r.error(!1)})})},t.prototype.login=function(t){var e=this,r=t.email,n=t.password,a=t.context,c=o.a.GRANT_TYPE,u=o.a.CLIENT_ID,s=o.a.CLIENT_SECRET;return new i.a(function(t){e.http.post(o.a.AUTH_URL+"/oauth/token",{username:r,password:n,grant_type:c,client_id:u,client_secret:s}).subscribe(function(r){var n=JSON.stringify({token:r,timeLogin:(new Date).getTime()});e.createTokenData(n,a),e.getUserAuthenticated().subscribe(function(r){var n=JSON.stringify(r.data);e.createUserData(n,a),e.redirectRole(a),t.next(e.getDataUser(a))},function(e){t.error(e.error)})},function(e){t.error(e.error)})})},t.prototype.redirectRole=function(t){this.router.navigate(["/"+a.b[this.getDataUser(t).role_id].path])},t.prototype.getUserAuthenticated=function(){return this.http.post(o.a.AUTH_URL+"/oauth/authenticated","")},t.prototype.createUserData=function(t,e){Object(n.a)("linno_user_data"+(e?"_"+e:"")),document.cookie="linno_user_data"+(e?"_"+e:"")+"="+t+";Max-Age=21600";var r=JSON.parse(t);this.aclService.attachRole(a.b[r.role_id].role),Object(n.f)(a.b[r.role_id])},t.prototype.createTokenData=function(t,e){Object(n.a)("linno_token"+(e?"_"+e:""));var r=JSON.parse(t),o=c.isObject(r)?r.token.expires_in:21600;document.cookie="linno_token"+(e?"_"+e:"")+"="+t+";Max-Age="+o,localStorage.setItem("context",e)},t.prototype.getDataUser=function(t){var e=Object(n.b)(t);return c.isEmpty(e)&&!c.isObject(e)?this.logout():e},t.prototype.logout=function(){Object(n.a)("linno_token"),Object(n.a)("linno_user_data"),this.router.navigate(["/"]),this.aclService.flushRoles()},t}()}}]);